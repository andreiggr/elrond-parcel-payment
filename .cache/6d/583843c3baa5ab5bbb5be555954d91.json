{"id":"node_modules/@elrondnetwork/erdjs/out/apiProvider.js","dependencies":[{"name":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js.map","includedInParent":true,"mtime":1647170304887},{"name":"/Users/mac/code/work/bitmarket/elrond-parcel/package.json","includedInParent":true,"mtime":1647174146392},{"name":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/package.json","includedInParent":true,"mtime":1647170304850},{"name":"axios","loc":{"line":35,"column":40,"index":1826},"parent":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js","resolved":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/axios/index.js"},{"name":"./errors","loc":{"line":36,"column":36,"index":1873},"parent":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js","resolved":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/errors.js"},{"name":"./logger","loc":{"line":37,"column":25,"index":1912},"parent":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js","resolved":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/logger.js"},{"name":"./networkStake","loc":{"line":38,"column":31,"index":1956},"parent":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js","resolved":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/networkStake.js"},{"name":"./stats","loc":{"line":39,"column":24,"index":1999},"parent":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js","resolved":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/stats.js"},{"name":"./transactionOnNetwork","loc":{"line":40,"column":39,"index":2050},"parent":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js","resolved":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/transactionOnNetwork.js"},{"name":"./token","loc":{"line":41,"column":24,"index":2101},"parent":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js","resolved":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/token.js"},{"name":"./nftToken","loc":{"line":42,"column":27,"index":2140},"parent":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js","resolved":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/nftToken.js"},{"name":"json-bigint","loc":{"line":43,"column":24,"index":2179},"parent":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/@elrondnetwork/erdjs/out/apiProvider.js","resolved":"/Users/mac/code/work/bitmarket/elrond-parcel/node_modules/json-bigint/index.js"}],"generated":{"js":"\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ApiProvider = void 0;\nconst axios_1 = __importDefault(require(\"axios\"));\nconst errors = __importStar(require(\"./errors\"));\nconst logger_1 = require(\"./logger\");\nconst networkStake_1 = require(\"./networkStake\");\nconst stats_1 = require(\"./stats\");\nconst transactionOnNetwork_1 = require(\"./transactionOnNetwork\");\nconst token_1 = require(\"./token\");\nconst nftToken_1 = require(\"./nftToken\");\nconst JSONbig = require(\"json-bigint\");\n/**\n * This is a temporary change, this will be the only provider used, ProxyProvider will be deprecated\n */\nclass ApiProvider {\n    /**\n     * Creates a new ApiProvider.\n     * @param url the URL of the Elrond Api\n     * @param config axios request config options\n     */\n    constructor(url, config) {\n        this.url = url;\n        this.config = Object.assign({}, config, {\n            timeout: 1000,\n            // See: https://github.com/axios/axios/issues/983 regarding transformResponse\n            transformResponse: [\n                function (data) {\n                    return JSONbig.parse(data);\n                },\n            ],\n        });\n    }\n    /**\n     * Fetches the Network Stake.\n     */\n    getNetworkStake() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.doGetGeneric(\"stake\", (response) => networkStake_1.NetworkStake.fromHttpResponse(response));\n        });\n    }\n    /**\n     * Fetches the Network Stats.\n     */\n    getNetworkStats() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.doGetGeneric(\"stats\", (response) => stats_1.Stats.fromHttpResponse(response));\n        });\n    }\n    /**\n     * Fetches the state of a {@link Transaction}.\n     */\n    getTransaction(txHash) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.doGetGeneric(`transactions/${txHash.toString()}`, (response) => transactionOnNetwork_1.TransactionOnNetwork.fromHttpResponse(response));\n        });\n    }\n    getToken(tokenIdentifier) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.doGetGeneric(`tokens/${tokenIdentifier}`, (response) => token_1.Token.fromHttpResponse(response));\n        });\n    }\n    getNFTToken(tokenIdentifier) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.doGetGeneric(`nfts/${tokenIdentifier}`, (response) => nftToken_1.NFTToken.fromHttpResponse(response));\n        });\n    }\n    /**\n     * Get method that receives the resource url and on callback the method used to map the response.\n     */\n    doGetGeneric(resourceUrl, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let response = yield this.doGet(resourceUrl);\n            return callback(response);\n        });\n    }\n    doGet(resourceUrl) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                let url = `${this.url}/${resourceUrl}`;\n                let response = yield axios_1.default.get(url, this.config);\n                return response.data;\n            }\n            catch (error) {\n                this.handleApiError(error, resourceUrl);\n            }\n        });\n    }\n    handleApiError(error, resourceUrl) {\n        if (!error.response) {\n            logger_1.Logger.warn(error);\n            throw new errors.ErrApiProviderGet(resourceUrl, error.toString(), error);\n        }\n        let errorData = error.response.data;\n        let originalErrorMessage = errorData.error || errorData.message || JSON.stringify(errorData);\n        throw new errors.ErrApiProviderGet(resourceUrl, originalErrorMessage, error);\n    }\n}\nexports.ApiProvider = ApiProvider;\n"},"sourceMaps":{"js":{"version":3,"file":"apiProvider.js","sourceRoot":"","sources":["../src/apiProvider.ts"],"names":[],"mappings":"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","sourcesContent":[null]}},"error":null,"hash":"da1be901be7bf15a41f7d2a19be91c64","cacheData":{"env":{}}}